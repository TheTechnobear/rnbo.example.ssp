#### WORK IN PROGRESS ### 


# Building 

This document discusses how to create and build modules for the SSP. 
it assumes you have setup the development environment **first**, which is detailed in DEVENV.md
.. do not proceed in with this doc, until you have setup the development. 



# General procedure

there are 4 general steps to setting up our environment for building SSP modules.
this document covers the last threee two step, the others are covered in the DEVENV document, and must be done first.


- install development tools 
- install required libraries (VST SDK and SSP Buildroot)
- download repository with code
- prepare build
- build module


note: you will need to ensure the build tools from the development enviroment are on your path.



## Download repo and prepare it.

we first download the code from github, I suggest putting the code in a directory somewhere

e.g. 
```
mkdir ~/projects
cd ~/projects
```

now download the code
```
git clone https://github.com/thetechnobear/rnbo.example.ssp
```

change into this project directory
```
cd rnbo.example.ssp
```

now we need to download the code this repo is dependent on , which is JUCE and the ssp-sdk
this is simple
```
git submodule update --init --recursive
```

ok, congratulations... now we are all set to create our first module!


## Creating a module

the repo we have downloaded contains a template project which we use to create YOUR specific module.



### STEP 1 - create your MODULE
the first step, we need to do is to 'copy' this project to your new module

we can do this using the create modules script, this takes ONE parameter the NAME of your module
lets create one called TEST.



note: we assume you are in the TOP level directory for this to work
e.g. `~/projects/rnbo.example.ssp`

```
./scripts/create_module.sh TEST
```

Important Note : ONLY use a 4 LETTER CODE.... nothing longer, and you need it to be UNIQUE for your module!

this will create a directory called 
```
~/projects/rnbo.example.ssp/modules/TEST
```

see at the bottom of this document, to understand a little about what create_module.sh does.




### STEP 2 - export your RNBO code to your module.

so the above template will not DO anything, wont even compile! 

we need the code generated by RNBO.

so open MAX, create an RNBO patch, then export the code to 
```~/projects/rnbo.example.ssp/modules/TEST/rnbo-export```


using RNBO is beyond the scope of this document ;) 


### STEP 3a - prepare the build
this step only needs to be done once, each time you create a new module.
as it prepares the build

we basically create a build directory, and then tell cmake to look for modules to compile.
```
mkdir build 
cd build 
cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_TOOLCHAIN_FILE=../xcSSP.cmake .. 
```


### STEP 3b - build out module
the moment of truth, we can now build our SSP module 
```
cd build 
cmake --build .
```

### STEP 4 - copy to SSP 
once the build is complete, it will tell you the location of the shared library (TEST.so) that has been built.
you can now copy this to the SSP sd card and place in plugins directory.


-----------------------------------------


# create_module.sh

what does this do? why might you want to review what happens?

the create modules script is very simple, it does 3 things

first, 
it copies the template project from template/rnbo.example.ssp to modules/your module name e.g. modules/TEST

second,
then we need to change the build details in modules 'makefile', in this example modules/TEST/CMakeLists.txt 
if you look at the template you will see XXXX as a placeholder for what we need to change.

finally, 
we add this new module to the list of modules that need to be built, by adding to modules/CMakeLists.txt
as the build will build all modules in modules/*


so why is this useful info?


first thing to understand is your module is a COPY of the template, you are free to change the code if you wish.
and so can have custom code for your module i.e. this is a STARTING point for your module.


second, if you EDIT modules/TEST/CMakeLists.txt, you can change a number of useful properties.. in particular the description.

finally... if you want to delete this project you can simply delete the modules/TEST directory.
but you also need to edit the modules/CMakeList.txt and remove
```
add_subdirectory(TEST)
```








